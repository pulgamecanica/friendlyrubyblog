<%
  # Local variables:
  # - series_list: collection of series to display
  # - title: (optional) title for the section (default: "Series")
  # - storage_key: (optional) localStorage key for view preference (default: "global_view_mode")
  # - show_count: (optional) show series count badge (default: true)

  storage_key = "global_view_mode"
  show_count = true if show_count.nil?
  title ||= "Series"
%>

<div data-controller="documents-view-toggle" data-documents-view-toggle-storage-key-value="<%= storage_key %>">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8 border-b border-gray-200 dark:border-gray-800 pb-4">
    <div class="flex items-center gap-3 font-mono">
      <h2 class="text-2xl font-normal text-gray-700 dark:text-gray-400"># <%= title %></h2>
      <% if show_count %>
        <span class="text-sm text-gray-500 dark:text-gray-600">
          (<%= series_list.count %>)
        </span>
      <% end %>
    </div>

    <!-- View Switcher -->
    <div class="flex items-center gap-1 text-xs font-mono">
      <button data-action="click->documents-view-toggle#showGrid"
              data-documents-view-toggle-target="gridButton"
              class="px-3 py-1 transition-colors"
              aria-label="Grid view">
        [grid]
      </button>
      <span class="text-gray-400 dark:text-gray-700">|</span>
      <button data-action="click->documents-view-toggle#showTable"
              data-documents-view-toggle-target="tableButton"
              class="px-3 py-1 transition-colors"
              aria-label="Table view">
        [list]
      </button>
    </div>
  </div>

  <!-- Grid View -->
  <div data-documents-view-toggle-target="gridView">
    <%= render partial: "public/series/grid", locals: { series_list: series_list } %>
  </div>

  <!-- Table View -->
  <div data-documents-view-toggle-target="tableView" class="hidden">
    <%= render partial: "public/series/table", locals: { series_list: series_list } %>
  </div>
</div>
