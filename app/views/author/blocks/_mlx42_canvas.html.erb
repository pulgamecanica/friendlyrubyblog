<div id="mlx42_preview_<%= block.id %>"
     data-controller="mlx42-runner"
     data-mlx42-runner-block-id-value="<%= block.id %>"
     data-mlx42-runner-js-url-value="<%= rails_blob_url(block.js_file) %>"
     data-mlx42-runner-wasm-url-value="<%= rails_blob_url(block.wasm_file) %>"
     data-mlx42-runner-data-url-value="<%= block.data_file.attached? ? rails_blob_url(block.data_file) : '' %>"
     class="relative">

  <!-- Canvas Container -->
  <div class="border-2 border-purple-300 rounded-lg overflow-hidden bg-black relative" style="max-width: 800px; margin: 0 auto;">
    <canvas id="mlx42_canvas_<%= block.id %>"
            data-mlx42-runner-target="canvas"
            tabindex="-1"
            width="800"
            height="600"
            class="w-full h-auto"></canvas>

    <!-- Controls Active Indicator -->
    <div data-mlx42-runner-target="captureIndicator"
         style="display: none;"
         class="absolute top-2 right-2 bg-green-600 text-white text-xs px-2 py-1 rounded shadow-lg">
      ðŸŽ® Controls Active (Click to disable)
    </div>
  </div>

  <!-- Console Output -->
  <div class="mt-4">
    <div class="flex items-center justify-between mb-2">
      <div class="text-sm font-medium text-gray-700">Console Output</div>
      <button type="button"
              onclick="document.getElementById('mlx42_console_<%= block.id %>').value = ''"
              class="text-xs text-gray-500 hover:text-gray-700">
        Clear
      </button>
    </div>
    <textarea id="mlx42_console_<%= block.id %>"
              data-mlx42-runner-target="console"
              rows="8"
              readonly
              class="w-full font-mono text-xs bg-gray-900 text-green-400 p-4 rounded border border-gray-700 focus:outline-none"></textarea>
  </div>

  <!-- Loading State -->
  <div data-mlx42-runner-target="loader"
       style="display: none;"
       class="absolute inset-0 bg-white bg-opacity-95 flex items-center justify-center rounded-lg">
    <div class="text-center">
      <div class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-purple-500 border-t-transparent"></div>
      <p class="mt-2 text-gray-600 text-sm font-medium">Loading WebAssembly...</p>
      <p data-mlx42-runner-target="loadProgress" class="text-xs text-gray-500 mt-1"></p>
    </div>
  </div>
</div>
